package com.elastisys.scale.commons.net.ip;

import static org.hamcrest.CoreMatchers.is;
import static org.junit.Assert.assertThat;

import java.util.Arrays;
import java.util.List;

import org.junit.Test;

/**
 * Exercises {@link IsPrivateIp}.
 *
 */
public class TestIsPrivateIp {

    /**
     * 10.0.0.0 - 10.255.255.255 is a private address range.
     */
    @Test
    public void test10NetworkRange() {

        assertThat(new IsPrivateIp().test("10.0.0.0"), is(true));
        assertThat(new IsPrivateIp().test("10.0.0.1"), is(true));
        assertThat(new IsPrivateIp().test("10.1.0.0"), is(true));
        assertThat(new IsPrivateIp().test("10.255.255.254"), is(true));
        assertThat(new IsPrivateIp().test("10.255.255.255"), is(true));

        // Test a few addresses just outside of range
        assertThat(new IsPrivateIp().test("9.255.255.255"), is(false));
        assertThat(new IsPrivateIp().test("11.0.0.0"), is(false));
        assertThat(new IsPrivateIp().test("10.255.255.256"), is(false));
    }

    /**
     * 172.16.0.0 - 172.31.255.255 is a private address range.
     */
    @Test
    public void test172NetworkRange() {

        assertThat(new IsPrivateIp().test("172.16.0.0"), is(true));
        assertThat(new IsPrivateIp().test("172.16.0.1"), is(true));
        assertThat(new IsPrivateIp().test("172.17.0.1"), is(true));
        assertThat(new IsPrivateIp().test("172.28.128.128"), is(true));
        assertThat(new IsPrivateIp().test("172.31.255.254"), is(true));
        assertThat(new IsPrivateIp().test("172.31.255.255"), is(true));

        // Test a few addresses just outside of range
        assertThat(new IsPrivateIp().test("172.15.255.255"), is(false));
        assertThat(new IsPrivateIp().test("172.32.0.0"), is(false));
    }

    /**
     * 192.168.0.0 - 192.168.255.255 is a private address range.
     */
    @Test
    public void test192NetworkRange() {

        assertThat(new IsPrivateIp().test("192.168.0.0"), is(true));
        assertThat(new IsPrivateIp().test("192.168.0.1"), is(true));
        assertThat(new IsPrivateIp().test("192.168.100.0"), is(true));
        assertThat(new IsPrivateIp().test("192.168.200.0"), is(true));
        assertThat(new IsPrivateIp().test("192.168.255.254"), is(true));
        assertThat(new IsPrivateIp().test("192.168.255.255"), is(true));

        // Test a few addresses just outside of range
        assertThat(new IsPrivateIp().test("192.167.255.255"), is(false));
        assertThat(new IsPrivateIp().test("192.169.0.0"), is(false));
    }

    /**
     * Exercise against a set of sample IP addresses that are definitely public
     * (global 500 IP list).
     */
    @Test
    public void onPublicIpAddresses() {
        List<String> global500IpAddresses = Arrays.asList("50.57.214.177", "23.46.116.229", "158.28.238.7",
                "23.46.125.165", "2.17.172.196", "203.133.238.164", "203.105.61.77", "210.77.176.143", "171.18.27.49",
                "219.143.68.120", "109.105.109.10", "2.17.163.159", "23.46.119.218", "8.254.251.254", "171.161.198.100",
                "8.254.223.254", "109.105.109.32", "209.200.152.13", "92.246.34.12", "194.127.81.31", "92.122.65.145",
                "87.248.207.253", "95.101.97.34", "23.2.120.90", "170.148.192.92", "15.217.49.152", "217.188.247.192",
                "216.58.233.137", "89.185.58.159", "141.113.97.32", "163.137.191.238", "88.221.99.46", "23.46.120.221",
                "109.105.109.24", "192.30.31.89", "158.191.171.18", "92.123.207.87", "95.101.97.175", "206.142.218.254",
                "2.16.69.222", "167.230.98.94", "8.254.223.254", "199.230.128.100", "192.230.77.2", "159.45.66.145",
                "109.105.109.17", "92.122.67.219", "212.63.232.34", "217.151.130.37", "164.109.25.248", "93.20.64.46",
                "82.112.124.177", "50.17.206.130", "54.229.96.156", "200.5.41.140", "164.61.205.49", "85.133.57.57",
                "94.100.251.10", "146.133.6.75", "149.111.144.71", "193.178.154.48", "150.63.3.21", "200.23.91.1",
                "210.226.40.156", "137.177.80.115", "203.247.134.19", "212.170.36.33", "23.46.117.154", "23.2.122.85",
                "217.167.134.241", "62.164.182.200", "195.135.184.180", "143.97.229.220", "211.130.204.6",
                "129.33.204.68", "117.136.139.2", "213.248.115.170", "23.46.114.93", "195.232.248.148",
                "151.249.91.156", "213.248.115.178", "195.28.229.187", "170.111.5.43", "151.91.34.112", "165.72.204.40",
                "180.210.234.78", "12.43.89.99", "111.87.30.33", "217.135.73.143", "130.76.96.19", "23.46.118.219",
                "217.107.215.12", "194.250.98.161", "213.56.124.101", "141.228.141.86", "213.248.115.194",
                "213.248.115.193", "78.141.187.21", "162.95.222.233", "153.100.5.140", "193.193.172.27",
                "162.123.19.220", "208.167.231.50", "185.63.192.20", "92.123.205.232", "170.38.17.155", "23.46.113.71",
                "12.197.161.72", "167.211.100.20", "83.125.32.111", "210.80.95.168", "160.83.8.78", "213.4.30.107",
                "92.122.64.44", "124.127.108.106", "213.248.115.136", "114.141.189.75", "202.221.130.8", "2.17.235.80",
                "2.19.188.228", "37.235.93.108", "149.211.232.12", "49.50.121.19", "213.248.115.203", "122.1.36.11",
                "213.248.115.169", "213.248.115.203", "159.82.147.19", "192.30.31.62", "176.34.185.74", "1.202.224.58",
                "23.46.124.162", "213.248.115.177", "210.226.37.129", "220.194.14.118", "92.122.65.142",
                "213.248.115.210", "69.172.200.108", "124.74.251.240", "213.248.115.195", "219.141.226.145",
                "173.203.64.14", "54.247.105.43", "213.248.115.171", "217.16.103.89", "170.66.11.10", "89.107.176.83",
                "198.240.216.35", "193.41.198.203", "88.221.96.26", "109.105.109.8", "46.19.180.223", "202.44.4.97",
                "218.19.148.193", "184.24.192.83", "133.163.128.191", "166.21.250.59", "104.16.45.20", "109.105.109.26",
                "194.156.202.140", "66.54.50.20", "216.154.222.145", "203.180.164.163", "64.179.227.117",
                "213.152.5.105", "212.121.182.97", "213.248.115.154", "8.247.14.128", "50.17.246.75", "93.184.221.133",
                "2.16.68.253", "116.50.79.208", "92.122.66.185", "81.200.197.202", "167.234.9.8", "83.138.157.88",
                "37.157.9.113", "156.54.82.96", "58.49.84.24", "193.5.111.13", "195.248.239.86", "213.248.115.137",
                "52.68.107.64", "219.238.141.137", "85.133.57.44", "87.255.157.10", "161.107.18.205", "210.133.111.148",
                "103.11.79.134", "106.162.242.107", "170.225.6.31", "218.44.42.141", "192.230.77.137", "2.17.45.15",
                "119.148.77.23", "199.181.132.249", "88.221.36.170", "203.178.93.29", "68.87.29.59", "211.94.93.165",
                "211.100.35.132", "23.46.123.113", "151.249.91.107", "157.127.13.195", "2.17.169.66", "109.105.109.18",
                "206.213.253.171", "91.142.135.129", "194.145.84.1", "212.149.50.184", "213.248.115.144",
                "72.52.10.182", "128.242.126.101", "217.22.97.1", "202.232.239.129", "188.94.252.215", "168.210.113.31",
                "206.210.28.21", "62.239.224.74", "124.74.238.87", "219.141.246.51", "23.46.119.116", "8.254.251.254",
                "12.34.100.148", "88.221.37.45", "109.105.109.10", "65.173.211.241", "213.248.115.200", "54.230.98.128",
                "88.221.98.70", "192.48.40.53", "212.93.36.137", "46.38.169.81", "138.224.0.100", "213.248.115.201",
                "202.228.52.66", "23.13.40.220", "210.226.37.129", "203.170.90.108", "23.46.118.137", "210.148.18.213",
                "54.246.243.121", "2.17.237.6", "2.19.116.18", "199.64.2.192", "165.249.0.65", "95.140.229.97",
                "95.140.228.128", "203.130.61.92", "202.229.24.176", "210.73.96.71", "192.0.79.33", "194.54.14.129",
                "219.127.146.130", "222.168.65.41", "91.198.67.16", "199.91.36.45", "212.21.169.2", "185.26.230.129",
                "210.152.225.79", "151.249.91.214", "193.57.244.24", "216.70.104.22", "168.62.206.235", "63.101.150.33",
                "128.241.121.56", "198.204.179.5", "184.170.133.76", "203.246.189.116", "81.8.26.21", "8.254.222.126",
                "114.255.172.100", "222.44.31.109", "202.248.229.57", "193.183.228.75", "94.124.134.53",
                "109.105.109.18", "202.154.204.222", "210.210.21.153", "104.46.233.83", "88.221.38.162",
                "206.152.32.35", "62.241.12.35", "193.98.108.67", "193.138.107.107", "213.248.115.179", "54.72.101.141",
                "213.181.33.145", "95.101.96.62", "95.142.107.231", "92.123.207.78", "202.248.253.50", "23.46.119.66",
                "217.19.248.132", "2.17.164.131", "202.32.144.62", "61.34.243.131", "213.248.115.193",
                "202.130.108.213", "91.192.13.151", "23.46.123.41", "164.53.234.193", "203.243.237.17",
                "117.239.178.110", "93.184.220.20", "195.24.247.166", "94.127.83.150", "2.16.68.36", "219.143.252.63",
                "124.17.25.193", "222.222.45.112", "123.126.105.130", "121.253.31.139", "138.91.75.57", "5.9.155.209",
                "2.17.162.232", "203.24.7.45", "212.121.137.218", "194.245.34.131", "91.223.125.51", "213.4.82.173",
                "91.196.105.71", "220.128.79.6", "95.101.99.238", "202.212.61.192", "114.255.242.158",
                "213.248.115.168", "202.96.11.182", "193.186.185.72", "199.46.198.88", "167.211.101.40",
                "162.136.190.192", "92.122.66.136", "8.254.212.126", "198.62.101.217", "205.251.242.103",
                "149.6.127.87", "191.238.103.54", "23.46.114.223", "72.52.7.164", "194.145.146.65", "77.73.82.184",
                "159.208.34.141", "114.251.205.140", "91.220.45.246", "205.173.130.132", "92.123.206.114",
                "123.199.129.20", "202.126.172.250", "180.149.244.20", "216.58.209.132", "219.238.174.216",
                "195.53.217.193", "128.134.135.166", "210.145.189.5", "65.169.6.150", "193.244.74.220",
                "141.129.200.200", "142.47.133.31", "52.69.16.68", "188.93.152.53", "23.46.118.140", "212.34.68.196",
                "210.51.52.83", "54.192.96.14", "219.143.217.156", "88.221.98.171", "118.151.175.46", "146.67.140.135",
                "211.193.192.91", "218.217.250.22", "149.6.127.27", "184.24.194.75", "142.70.144.18", "68.170.129.130",
                "193.29.5.13", "203.189.169.180", "202.69.26.11", "217.31.1.35", "206.75.245.87", "210.150.59.142",
                "217.150.155.36", "202.241.190.68", "169.153.202.100", "54.194.131.196", "88.221.99.224",
                "84.201.97.90", "213.248.115.193", "2.16.95.209", "180.210.234.69", "40.255.166.96", "213.248.115.218",
                "91.212.223.68", "202.2.56.40", "206.152.33.29", "92.122.67.64", "151.249.91.222", "122.215.192.101",
                "192.230.77.141", "198.155.190.60", "195.35.76.231", "118.151.177.127", "164.109.155.122",
                "212.98.109.16", "180.179.158.197", "2.19.181.9", "219.141.254.253", "202.54.250.45", "109.105.109.10",
                "61.177.60.83", "2.17.162.157", "202.230.50.41", "88.221.39.82", "109.105.109.8", "144.191.142.13",
                "213.248.115.170", "217.167.147.157", "155.188.165.139", "194.31.62.160", "195.77.63.225",
                "46.19.182.130", "87.248.207.254", "61.183.132.100", "118.151.161.70", "95.211.71.107", "203.67.170.51",
                "212.210.29.236", "168.233.1.140", "203.69.155.1", "92.123.205.41", "202.106.90.143", "54.235.139.55",
                "133.153.71.81", "5.61.65.13", "124.74.240.136", "80.75.158.8", "123.108.45.96", "170.135.184.252",
                "217.114.93.205", "106.187.123.14", "161.68.129.119", "198.74.81.27", "52.7.51.118", "46.137.177.183",
                "144.95.64.7", "23.46.118.203", "203.69.42.197", "213.248.115.144", "50.57.49.213", "151.249.91.241",
                "94.124.235.58", "46.243.124.11", "58.162.89.137", "62.132.193.64", "212.18.19.40", "192.135.121.21",
                "61.121.113.76", "94.100.253.195", "54.200.199.221", "2.16.68.181", "213.150.2.156", "170.48.11.162",
                "202.147.2.137", "209.37.4.68", "149.216.106.61", "200.166.77.69", "62.249.32.40", "211.12.26.140",
                "150.30.21.101", "46.51.184.255", "144.57.130.15", "219.142.82.10", "71.74.42.231", "133.242.29.118",
                "213.192.202.12", "203.180.140.61", "217.70.186.105", "23.46.117.102", "98.129.177.83",
                "210.228.154.205", "80.120.2.200", "193.0.238.161", "174.142.116.238", "118.151.161.170",
                "91.208.160.171", "198.29.234.89", "184.106.55.84", "194.11.167.166", "213.206.227.150",
                "213.248.115.177", "54.164.103.238", "153.122.11.91", "184.106.55.73", "91.151.76.132",
                "210.133.105.48");

        for (String publicIp : global500IpAddresses) {
            assertThat(new IsPrivateIp().test(publicIp), is(false));
        }
    }

}
